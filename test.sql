CREATE DATABASE THU;
USE THU;

CREATE TABLE PART (
    P_PARTKEY        INT,
    P_NAME           VARCHAR(55),
    P_MFGR           VARCHAR(25),
    P_BRAND          VARCHAR(10),
    P_TYPE           VARCHAR(25),
    P_SIZE           INT,
    P_CONTAINER      VARCHAR(10),
    P_RETAILPRICE    FLOAT,
    P_COMMENT        VARCHAR(23)
);

ALTER TABLE PART ADD INDEX (P_PARTKEY);

-- LOAD FROM FILE '../data-with-date/part_short.csv' TO TABLE PART;
LOAD FROM FILE '../data-with-date/part.csv' TO TABLE PART;

-- SELECT * FROM PART WHERE PART.P_PARTKEY = 336;
-- SELECT * FROM PART WHERE PART.P_PARTKEY = 337;
-- SELECT * FROM PART WHERE PART.P_PARTKEY = 338;
SELECT * FROM PART WHERE PART.P_PARTKEY = 339;
-- SELECT * FROM PART WHERE PART.P_PARTKEY = 340;
-- SELECT * FROM PART WHERE PART.P_PARTKEY = 341;


SELECT * FROM PART WHERE PART.P_PARTKEY = 0;
SELECT * FROM PART WHERE PART.P_PARTKEY >= 100 AND PART.P_PARTKEY < 200;
UPDATE PART SET P_PARTKEY = 0 WHERE PART.P_PARTKEY >= 100 AND PART.P_PARTKEY < 200;

SELECT * FROM PART WHERE PART.P_PARTKEY = 0;
SELECT * FROM PART WHERE PART.P_PARTKEY >= 100 AND PART.P_PARTKEY < 200;