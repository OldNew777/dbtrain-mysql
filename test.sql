
CREATE DATABASE THU;

USE THU;

-- CREATE TABLE PARTSUPP (
--     PS_PARTKEY        INT NOT NULL,
--     PS_SUPPKEY        INT NOT NULL,
--     PS_AVAILQTY       INT,
--     PS_SUPPLYCOST     FLOAT,
--     PS_COMMENT        VARCHAR(199)
-- );

-- LOAD FROM FILE '../data-with-date/partsupp.csv' TO TABLE PARTSUPP;
-- SELECT * FROM PARTSUPP WHERE PARTSUPP.PS_SUPPKEY = 1111;
-- ALTER TABLE PARTSUPP ADD INDEX (PS_SUPPKEY);

-- SELECT * FROM PARTSUPP WHERE PARTSUPP.PS_SUPPKEY = 1111;

CREATE TABLE PART (
    P_PARTKEY        INT,
    P_NAME           VARCHAR(55),
    P_MFGR           VARCHAR(25),
    P_BRAND          VARCHAR(10),
    P_TYPE           VARCHAR(25),
    P_SIZE           INT,
    P_CONTAINER      VARCHAR(10),
    P_RETAILPRICE    FLOAT,
    P_COMMENT        VARCHAR(23)
);

-- LOAD FROM FILE '../data-with-date/part_short.csv' TO TABLE PART;
LOAD FROM FILE '../data-with-date/part.csv' TO TABLE PART;
ALTER TABLE PART ADD INDEX(P_PARTKEY);

-- SELECT * FROM PART WHERE PART.P_PARTKEY = 336;
-- SELECT * FROM PART WHERE PART.P_PARTKEY = 337;
-- SELECT * FROM PART WHERE PART.P_PARTKEY = 338;
-- SELECT * FROM PART WHERE PART.P_PARTKEY = 339;
-- SELECT * FROM PART WHERE PART.P_PARTKEY = 340;
-- SELECT * FROM PART WHERE PART.P_PARTKEY = 341;


-- SELECT * FROM PART WHERE PART.P_PARTKEY = 0;
-- SELECT * FROM PART WHERE PART.P_PARTKEY >= 100 AND PART.P_PARTKEY < 200;
-- UPDATE PART SET P_PARTKEY = 0 WHERE PART.P_PARTKEY >= 100 AND PART.P_PARTKEY < 200;
-- SELECT * FROM PART WHERE PART.P_PARTKEY = 0;
-- SELECT * FROM PART WHERE PART.P_PARTKEY >= 100 AND PART.P_PARTKEY < 200;


-- SELECT * FROM PART WHERE PART.P_PARTKEY >= 900 AND PART.P_PARTKEY < 1000;
DELETE FROM PART WHERE PART.P_PARTKEY >= 900 AND PART.P_PARTKEY < 1000;
SELECT * FROM PART WHERE PART.P_PARTKEY >= 890 AND PART.P_PARTKEY < 1010;


-- SELECT * FROM PART WHERE PART.P_PARTKEY >= 250 AND PART.P_PARTKEY < 300;
-- SELECT * FROM PART WHERE PART.P_PARTKEY >= 300 AND PART.P_PARTKEY < 500;
-- DELETE FROM PART WHERE PART.P_PARTKEY >= 250 AND PART.P_PARTKEY < 400;
-- SELECT * FROM PART WHERE PART.P_PARTKEY >= 300 AND PART.P_PARTKEY < 500;
-- SELECT * FROM PART WHERE PART.P_PARTKEY >= 250 AND PART.P_PARTKEY < 300;